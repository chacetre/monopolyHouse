{"ast":null,"code":"import _slicedToArray from\"/Users/charlottecetre/Desktop/Macron business/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{makeStyles}from\"@material-ui/styles\";import{Typography,Button,Divider,IconButton}from\"@material-ui/core\";import Table from\"@material-ui/core/Table\";import TableBody from\"@material-ui/core/TableBody\";import TableCell from\"@material-ui/core/TableCell\";import TableContainer from\"@material-ui/core/TableContainer\";import TableHead from\"@material-ui/core/TableHead\";import TableRow from\"@material-ui/core/TableRow\";import Paper from\"@material-ui/core/Paper\";import html2canvas from\"html2canvas\";import Template from\"./Template\";import jsPDF from\"jspdf\";import{CalendarTodayRounded,GetAppRounded}from\"@material-ui/icons\";import{useOwner}from\"../../context/owner\";import{getAccomodationByOwner}from\"request/accomodationAPI\";import MonthYearPicker from\"components/MonthYearPicker\";var useStyles=makeStyles(function(theme){return{root:{padding:theme.spacing(3),margin:theme.spacing(2)},content:{marginBottom:theme.spacing(2)},destinataire:{color:theme.palette.primary.main},expediteur:{textAlign:\"right\"},page:{position:\"absolute\",opacity:0,pointerEvents:\"none\"},pageBis:{backgroundColor:\"#fff000\",width:\"210mm\",height:\"297mm\",padding:30},divider:{margin:20},test:{display:\"flex\",justifyContent:\"center\",alignItems:\"center\"},icon:{marginLeft:10,height:40,width:40}};});var Receipt=function Receipt(){var classes=useStyles();var currentDate=new Date().toLocaleString(\"default\",{month:\"long\",year:\"numeric\"});var _useOwner=useOwner(),ownerInformations=_useOwner.ownerInformations;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),accommodations=_useState2[0],setData=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),currentAccomodation=_useState4[0],setCurrentAccommodation=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),dateReceipt=_useState6[0],setDateReceipt=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),showPicker=_useState8[0],setShowPicker=_useState8[1];function createPDF(currentAccomodation){var namePDF=currentAccomodation.rental.firstname+\"_\"+currentAccomodation.rental.lastname+\"_\"+dateReceipt.month+\"_\"+dateReceipt.year+\".pdf\";var input=document.querySelector(\".divToPrint\");if(input!=null){html2canvas(input).then(function(canvas){var image=canvas.toDataURL(\"image/png\");var pdf=jsPDF(\"p\",\"mm\",\"a4\");var width=210;var height=297;pdf.addImage(image,0,0,width,height);pdf.save(namePDF);});}else{console.log(\"isNULL\");}}function calculateLoyer(estate){var numFixe=Number(estate.loyer.fixe);var numCharges=Number(estate.loyer.charges);var numTVA=estate.isCommercial==undefined?Number(estate.loyer.tva):0;return numFixe+numCharges+numTVA;}function getAccommodationsInformations(){getAccomodationByOwner(ownerInformations.id,function(response){setData(response);});}function showCalendar(currentAccomodation){setShowPicker(function(prev){return!prev;});setCurrentAccommodation(currentAccomodation);}useEffect(function(){getAccommodationsInformations();},[]);useEffect(function(){if(currentDate!=undefined){var splitDate=currentDate.split(\" \");setDateReceipt({month:splitDate[0],year:splitDate[1]});}},[currentDate]);return/*#__PURE__*/React.createElement(\"div\",{className:classes.root},/*#__PURE__*/React.createElement(\"div\",{className:classes.content},/*#__PURE__*/React.createElement(Typography,{variant:\"h2\"},\"EDITION DES QUITTANCES ET APPELS DE LOYER\"),/*#__PURE__*/React.createElement(Typography,{variant:\"overline\"},\"Date actuelle:\",\" \",currentDate.toLocaleString(\"default\",{month:\"long\"}))),/*#__PURE__*/React.createElement(MonthYearPicker,{open:showPicker,initialValue:currentDate.toLocaleString(\"default\",{month:\"long\"}),currentAccomodation:currentAccomodation,ownerInformations:ownerInformations,onClose:function onClose(monthReturn,yearReturn){setDateReceipt({month:monthReturn,year:yearReturn});setShowPicker(false);}}),/*#__PURE__*/React.createElement(TableContainer,{component:Paper},/*#__PURE__*/React.createElement(Table,{className:classes.table,\"aria-label\":\"simple table\"},/*#__PURE__*/React.createElement(TableHead,null,/*#__PURE__*/React.createElement(TableRow,null,/*#__PURE__*/React.createElement(TableCell,null,\"Logements\"),/*#__PURE__*/React.createElement(TableCell,null,\"Locataire\"),/*#__PURE__*/React.createElement(TableCell,{align:\"right\"},\"Montant du loyer\"),/*#__PURE__*/React.createElement(TableCell,{align:\"right\"},\"Appel de loyer\"),/*#__PURE__*/React.createElement(TableCell,{align:\"right\"},\"Quittance\"))),/*#__PURE__*/React.createElement(TableBody,null,accommodations!=undefined&&Object.values(accommodations).map(function(row){return/*#__PURE__*/React.createElement(TableRow,{key:row.id},/*#__PURE__*/React.createElement(TableCell,{component:\"th\",scope:\"row\"},/*#__PURE__*/React.createElement(\"div\",null,row.address.street.toUpperCase()),/*#__PURE__*/React.createElement(\"div\",null,row.address.otherInformations),/*#__PURE__*/React.createElement(\"div\",null,row.address.city.toUpperCase())),/*#__PURE__*/React.createElement(TableCell,null,!row.isParticulier?row.rental.civility.toUpperCase()+\" \"+row.rental.firstname.toUpperCase()+\" \"+row.rental.lastname.toUpperCase():row.rental.socialIdentity),/*#__PURE__*/React.createElement(TableCell,{align:\"right\"},calculateLoyer(row),\" \\u20AC\"),/*#__PURE__*/React.createElement(TableCell,{align:\"right\"},/*#__PURE__*/React.createElement(Button,{size:\"small\",variant:\"outlined\",onClick:function onClick(){return showCalendar(row);}},dateReceipt.month,\" \",dateReceipt.year,\" \",/*#__PURE__*/React.createElement(CalendarTodayRounded,null)),/*#__PURE__*/React.createElement(Button,{variant:\"contained\",className:classes.icon,onClick:function onClick(){return createPDF(row);}},/*#__PURE__*/React.createElement(GetAppRounded,null))),/*#__PURE__*/React.createElement(TableCell,{align:\"right\"},/*#__PURE__*/React.createElement(Button,{size:\"small\",variant:\"outlined\",onClick:createPDF},currentDate),/*#__PURE__*/React.createElement(Template,{owner:ownerInformations,accomodation:row,date:dateReceipt}),/*#__PURE__*/React.createElement(Button,{className:classes.icon},/*#__PURE__*/React.createElement(GetAppRounded,null))));})))));};export default Receipt;","map":{"version":3,"sources":["/Users/charlottecetre/Desktop/Macron business/src/views/Receipt/index.js"],"names":["React","useState","useEffect","makeStyles","Typography","Button","Divider","IconButton","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Paper","html2canvas","Template","jsPDF","CalendarTodayRounded","GetAppRounded","useOwner","getAccomodationByOwner","MonthYearPicker","useStyles","theme","root","padding","spacing","margin","content","marginBottom","destinataire","color","palette","primary","main","expediteur","textAlign","page","position","opacity","pointerEvents","pageBis","backgroundColor","width","height","divider","test","display","justifyContent","alignItems","icon","marginLeft","Receipt","classes","currentDate","Date","toLocaleString","month","year","ownerInformations","accommodations","setData","currentAccomodation","setCurrentAccommodation","dateReceipt","setDateReceipt","showPicker","setShowPicker","createPDF","namePDF","rental","firstname","lastname","input","document","querySelector","then","canvas","image","toDataURL","pdf","addImage","save","console","log","calculateLoyer","estate","numFixe","Number","loyer","fixe","numCharges","charges","numTVA","isCommercial","undefined","tva","getAccommodationsInformations","id","response","showCalendar","prev","splitDate","split","monthReturn","yearReturn","table","Object","values","map","row","address","street","toUpperCase","otherInformations","city","isParticulier","civility","socialIdentity"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { makeStyles } from \"@material-ui/styles\";\nimport { func } from \"prop-types\";\nimport { Typography, Button, Divider, IconButton } from \"@material-ui/core\";\nimport Table from \"@material-ui/core/Table\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableContainer from \"@material-ui/core/TableContainer\";\nimport TableHead from \"@material-ui/core/TableHead\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport Paper from \"@material-ui/core/Paper\";\nimport html2canvas from \"html2canvas\";\nimport Template from \"./Template\";\nimport jsPDF from \"jspdf\";\nimport { CalendarTodayRounded, GetAppRounded } from \"@material-ui/icons\";\nimport { useOwner } from \"../../context/owner\";\nimport { getAccomodationByOwner } from \"request/accomodationAPI\";\nimport MonthYearPicker from \"components/MonthYearPicker\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    padding: theme.spacing(3),\n    margin: theme.spacing(2),\n  },\n  content: {\n    marginBottom: theme.spacing(2),\n  },\n  destinataire: {\n    color: theme.palette.primary.main,\n  },\n  expediteur: {\n    textAlign: \"right\",\n  },\n  page: {\n    position: \"absolute\",\n    opacity: 0,\n    pointerEvents: \"none\",\n  },\n  pageBis: {\n    backgroundColor: \"#fff000\",\n    width: \"210mm\",\n    height: \"297mm\",\n    padding: 30,\n  },\n  divider: {\n    margin: 20,\n  },\n  test: {\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n  icon: {\n    marginLeft: 10,\n    height : 40,\n    width: 40\n  }\n}));\n\nconst Receipt = () => {\n  const classes = useStyles();\n  const currentDate = new Date().toLocaleString(\"default\", {\n    month: \"long\",\n    year: \"numeric\",\n  });\n  const { ownerInformations } = useOwner();\n  const [accommodations, setData] = useState(null);\n  const [currentAccomodation, setCurrentAccommodation] = useState(null);\n  const [dateReceipt, setDateReceipt] = useState({});\n  const [showPicker, setShowPicker] = useState(false);\n\n  function createPDF(currentAccomodation) {\n    var namePDF = currentAccomodation.rental.firstname + \"_\" + currentAccomodation.rental.lastname + \"_\" + dateReceipt.month + \"_\" + dateReceipt.year + \".pdf\"\n\n    const input = document.querySelector(\".divToPrint\");\n    if (input != null) {\n      html2canvas(input).then((canvas) => {\n        const image = canvas.toDataURL(\"image/png\");\n        const pdf = jsPDF(\"p\", \"mm\", \"a4\");\n        const width = 210;\n        const height = 297;\n        pdf.addImage(image, 0, 0, width, height);\n        pdf.save(namePDF);\n      });\n    } else {\n      console.log(\"isNULL\");\n    }\n  }\n\n  function calculateLoyer(estate) {\n    var numFixe = Number(estate.loyer.fixe);\n    var numCharges = Number(estate.loyer.charges);\n    var numTVA =\n      estate.isCommercial == undefined ? Number(estate.loyer.tva) : 0;\n\n    return numFixe + numCharges + numTVA;\n  }\n\n  function getAccommodationsInformations() {\n    getAccomodationByOwner(ownerInformations.id, (response) => {\n      setData(response);\n    });\n  }\n\n  function showCalendar(currentAccomodation) {\n    setShowPicker((prev) => !prev);\n    setCurrentAccommodation(currentAccomodation)\n  }\n\n  useEffect(() => {\n    getAccommodationsInformations();\n  }, []);\n\n  useEffect(() => {\n    if (currentDate != undefined) {\n\n      var splitDate = currentDate.split(\" \");\n      setDateReceipt({\n        month: splitDate[0],\n        year: splitDate[1],\n      });\n    }\n  }, [currentDate]);\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.content}>\n        <Typography variant=\"h2\">\n          EDITION DES QUITTANCES ET APPELS DE LOYER\n        </Typography>\n        <Typography variant=\"overline\">\n          Date actuelle:{\" \"}\n          {currentDate.toLocaleString(\"default\", { month: \"long\" })}\n        </Typography>\n      </div>\n\n      <MonthYearPicker\n        open={showPicker}\n        initialValue={currentDate.toLocaleString(\"default\", { month: \"long\" })}\n        currentAccomodation={currentAccomodation}\n        ownerInformations={ownerInformations}\n        onClose={(monthReturn, yearReturn) => {\n          setDateReceipt({ month: monthReturn, year: yearReturn });\n          setShowPicker(false);\n        }}\n      />\n\n      <TableContainer component={Paper}>\n        <Table className={classes.table} aria-label=\"simple table\">\n          <TableHead>\n            <TableRow>\n              <TableCell>Logements</TableCell>\n              <TableCell>Locataire</TableCell>\n              <TableCell align=\"right\">Montant du loyer</TableCell>\n              <TableCell align=\"right\">Appel de loyer</TableCell>\n              <TableCell align=\"right\">Quittance</TableCell>\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {accommodations != undefined &&\n              Object.values(accommodations).map((row) => (\n                <TableRow key={row.id}>\n                  <TableCell component=\"th\" scope=\"row\">\n                    <div>{row.address.street.toUpperCase()}</div>\n                    <div>{row.address.otherInformations}</div>\n                    <div>{row.address.city.toUpperCase()}</div>\n                  </TableCell>\n                  <TableCell>\n                    {!row.isParticulier\n                      ? row.rental.civility.toUpperCase() +\n                        \" \" +\n                        row.rental.firstname.toUpperCase() +\n                        \" \" +\n                        row.rental.lastname.toUpperCase()\n                      : row.rental.socialIdentity}\n                  </TableCell>\n                  <TableCell align=\"right\">{calculateLoyer(row)} €</TableCell>\n                  <TableCell align=\"right\">\n                    <Button\n                      size=\"small\"\n                      variant=\"outlined\"\n                      onClick={() => showCalendar(row)}\n                    >\n                      {dateReceipt.month} {dateReceipt.year} <CalendarTodayRounded/>\n                    </Button>\n                    <Button variant=\"contained\" className={classes.icon}  onClick={() => createPDF(row)} >\n                      <GetAppRounded />\n                    </Button>\n                  </TableCell>\n                  <TableCell align=\"right\">\n                    <Button\n                      size=\"small\"\n                      variant=\"outlined\"\n                      onClick={createPDF}\n                    >\n                      {currentDate}\n                    </Button>\n                    <Template owner={ownerInformations} accomodation={row} date={dateReceipt} />\n                    <Button className={classes.icon} >\n                      <GetAppRounded />\n                    </Button>\n                  </TableCell>\n                </TableRow>\n              ))}\n          </TableBody>\n        </Table>\n      </TableContainer>\n\n      \n    </div>\n  );\n};\n\nexport default Receipt;\n"]},"metadata":{},"sourceType":"module"}