{"ast":null,"code":"import _defineProperty from\"/Users/charlottecetre/Desktop/Macron business/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/charlottecetre/Desktop/Macron business/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/charlottecetre/Desktop/Macron business/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectWithoutProperties from\"/Users/charlottecetre/Desktop/Macron business/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import React,{useState,useEffect}from\"react\";import validate from\"validate.js\";import clsx from\"clsx\";import{makeStyles,withStyles}from\"@material-ui/styles\";import{Modal,Card,CardHeader,CardContent,CardActions,Grid,Divider,Typography,Radio,RadioGroup,FormControlLabel,FormControl,Button,TextField,Select,FormHelperText}from\"@material-ui/core\";import firebase from\"firebase/app\";import Particulier from\"./Particulier\";import{useOwner}from\"../../../context/owner\";import Society from\"./Society\";import{saveNewAccommodation}from\"request/accomodationAPI\";import Loyer from\"./Loyer\";import Address from\"./Address\";var useStyles=makeStyles(function(theme){return{root:{position:\"absolute\",top:\"50%\",left:\"50%\",transform:\"translate(-50%, -50%)\",outline:\"none\",boxShadow:theme.shadows[20],width:\"60%\",maxHeight:\"90%\",overflowY:\"auto\",maxWidth:\"100%\"},actions:{justifyContent:\"flex-end\"},center:{display:\"flex\",justifyContent:\"center\",alignItems:\"center\"},divider:{margin:10},titleSection:{marginRight:15,marginLeft:10},gridCell:{alignItems:\"center\"},textField:{marginTop:theme.spacing(2)},container:{marginTop:0,marginBottom:theme.spacing(2)}};});var schema={address:{presence:{allowEmpty:false,message:\"is required\"}},isCommercial:{presence:{allowEmpty:false,message:\"is required\"}}};var schemaAddress={postalCode:{presence:{allowEmpty:false,message:\"is required\"},length:{maximum:5,minimum:5}},street:{presence:{allowEmpty:false,message:\"is required\"}},city:{presence:{allowEmpty:false,message:\"is required\"}}};var schemaLoyer={fixe:{presence:{allowEmpty:false,message:\"is required\"}},charges:{presence:{allowEmpty:false,message:\"is required\"}}};var schemaRental={};function AddEstateModal(_ref){var open=_ref.open,className=_ref.className,onClose=_ref.onClose,rest=_objectWithoutProperties(_ref,[\"open\",\"className\",\"onClose\"]);var classes=useStyles();var _useOwner=useOwner(),ownerInformations=_useOwner.ownerInformations;var _useState=useState({isValid:false,values:{rental:{},address:{}},touched:{},errors:{}}),_useState2=_slicedToArray(_useState,2),currentAccommo=_useState2[0],setCurrentAccommo=_useState2[1];function createEstateDB(){var timestamp=Date.now();saveNewAccommodation(currentAccommo.values,timestamp,ownerInformations.id);onClose();}function createEstate(){if(currentAccommo.isValid){createEstateDB();}}var handleChange=function handleChange(event){event.persist();setCurrentAccommo(function(formState){return _objectSpread(_objectSpread({},formState),{},{values:_objectSpread(_objectSpread({},formState.values),{},_defineProperty({},event.target.name,event.target.type===\"checkbox\"?event.target.checked:event.target.value)),touched:_objectSpread(_objectSpread({},formState.touched),{},_defineProperty({},event.target.name,true))});});};var handleChangeLoyer=function handleChangeLoyer(event){event.persist();setCurrentAccommo(function(formState){return _objectSpread(_objectSpread({},formState),{},{values:_objectSpread(_objectSpread({},formState.values),{},{loyer:_objectSpread(_objectSpread({},formState.values.loyer),{},_defineProperty({},event.target.name,event.target.value))}),touched:_objectSpread(_objectSpread({},formState.touched),{},_defineProperty({},event.target.name,true))});});};var handleChangeRental=function handleChangeRental(event){event.persist();setCurrentAccommo(function(formState){return _objectSpread(_objectSpread({},formState),{},{values:_objectSpread(_objectSpread({},formState.values),{},{rental:_objectSpread(_objectSpread({},formState.values.rental),{},_defineProperty({},event.target.name,event.target.value))}),touched:_objectSpread(_objectSpread({},formState.touched),{},_defineProperty({},event.target.name,true))});});};var handleChangeAddress=function handleChangeAddress(event){event.persist();setCurrentAccommo(function(formState){return _objectSpread(_objectSpread({},formState),{},{values:_objectSpread(_objectSpread({},formState.values),{},{address:_objectSpread(_objectSpread({},formState.values.address),{},_defineProperty({},event.target.name,event.target.value))}),touched:_objectSpread(_objectSpread({},formState.touched),{},_defineProperty({},event.target.name,true))});});};var cancelClose=function cancelClose(){onClose();};var hasError=function hasError(field){return currentAccommo.touched[field]&&currentAccommo.errors[field]?true:false;};useEffect(function(){var errorsGeneral=validate(currentAccommo.values,schema);var errorsAddress=validate(currentAccommo.values.address,schemaAddress);var errorsRental=validate(currentAccommo.values.rental,schemaRental);var errorsLoyer=validate(currentAccommo.values.loyer,schemaLoyer);var errors=Object.assign({},errorsGeneral,errorsAddress,errorsRental,errorsLoyer);if(Object.keys(errors).length===0){errors=undefined;}console.log(\"errors\",errors);setCurrentAccommo(function(formState){return _objectSpread(_objectSpread({},formState),{},{isValid:errors?false:true,errors:errors||{}});});},[currentAccommo.values]);if(!open){return null;}return/*#__PURE__*/React.createElement(Modal,{onClose:onClose,open:open},/*#__PURE__*/React.createElement(Card,Object.assign({},rest,{className:clsx(classes.root,className)}),/*#__PURE__*/React.createElement(CardHeader,{title:\"Ajouter un nouveau bien\"}),/*#__PURE__*/React.createElement(Divider,null),/*#__PURE__*/React.createElement(CardContent,null,/*#__PURE__*/React.createElement(FormControl,{component:\"fieldset\",error:true,className:classes.formControl},/*#__PURE__*/React.createElement(RadioGroup,{row:true,name:\"isCommercial\",defaultValue:\"top\",onChange:handleChange,className:classes.gridCell},/*#__PURE__*/React.createElement(Typography,{variant:\"h4\",className:classes.titleSection},\"1. Type de bien\"),/*#__PURE__*/React.createElement(FormControlLabel,{value:\"false\",control:/*#__PURE__*/React.createElement(Radio,{color:\"primary\",checked:currentAccommo.values.isCommercial===\"false\"}),label:\"Habitation\",labelPlacement:\"right\"}),/*#__PURE__*/React.createElement(FormControlLabel,{value:\"true\",control:/*#__PURE__*/React.createElement(Radio,{color:\"primary\",checked:currentAccommo.values.isCommercial===\"true\"}),label:\"Local Commercial\",labelPlacement:\"right\"})),hasError(\"isCommercial\")?/*#__PURE__*/React.createElement(Typography,null,\"currentAccommo.errors.isCommercial[0]\"):null),/*#__PURE__*/React.createElement(Typography,{variant:\"h4\",className:classes.titleSection},\"2. Adresse\"),/*#__PURE__*/React.createElement(Address,{handleChange:handleChangeAddress,currentAccommo:currentAccommo}),/*#__PURE__*/React.createElement(RadioGroup,{row:true,name:\"isParticulier\",defaultValue:\"top\",onChange:handleChangeRental,className:classes.gridCell},/*#__PURE__*/React.createElement(Typography,{variant:\"h4\",className:classes.titleSection},\"3. Locataire\"),/*#__PURE__*/React.createElement(FormControlLabel,{value:\"null\",control:/*#__PURE__*/React.createElement(Radio,{color:\"primary\",checked:currentAccommo.values.rental.isParticulier===\"null\"}),label:\"Vide\",labelPlacement:\"right\"}),/*#__PURE__*/React.createElement(FormControlLabel,{value:\"true\",control:/*#__PURE__*/React.createElement(Radio,{color:\"primary\",checked:currentAccommo.values.rental.isParticulier===\"true\"}),label:\"Particulier\",labelPlacement:\"right\"}),/*#__PURE__*/React.createElement(FormControlLabel,{value:\"false\",control:/*#__PURE__*/React.createElement(Radio,{color:\"primary\",checked:currentAccommo.values.rental.isParticulier===\"false\"}),label:\"Entreprise\",labelPlacement:\"right\"})),/*#__PURE__*/React.createElement(TextField,{size:\"small\",fullWidth:true,error:hasError(\"startDate\"),helperText:hasError(\"startDate\")?currentAccommo.errors.startDate[0]:null,label:\"Date d'entr\\xE9e\",name:\"startDate\",onChange:handleChangeRental,type:\"text\",value:currentAccommo.values.rental!=undefined&&currentAccommo.values.rental.startDate||\"\",variant:\"outlined\"}),/*#__PURE__*/React.createElement(\"div\",{className:classes.container},currentAccommo.values.rental.isParticulier===\"true\"&&/*#__PURE__*/React.createElement(Particulier,{handleChange:handleChangeRental,currentOwner:currentAccommo.values,disabled:true}),currentAccommo.values.rental.isParticulier===\"false\"&&/*#__PURE__*/React.createElement(Society,{handleChange:handleChangeRental,currentEstate:currentAccommo.values,disabled:true})),/*#__PURE__*/React.createElement(Typography,{variant:\"h4\",className:classes.titleSection},\"4. Loyer\"),/*#__PURE__*/React.createElement(Loyer,{handleChange:handleChangeLoyer,currentEstate:currentAccommo.values})),/*#__PURE__*/React.createElement(Divider,null),/*#__PURE__*/React.createElement(CardActions,{disableSpacing:true},/*#__PURE__*/React.createElement(Button,{onClick:cancelClose},\"annuler\"),/*#__PURE__*/React.createElement(Button,{onClick:createEstate},\"cr\\xE9er\"))));}AddEstateModal.defaultProps={open:false,onClose:function onClose(){}};export default AddEstateModal;","map":{"version":3,"sources":["/Users/charlottecetre/Desktop/Macron business/src/views/Accomodation/Components/AddEstateModal.js"],"names":["React","useState","useEffect","validate","clsx","makeStyles","withStyles","Modal","Card","CardHeader","CardContent","CardActions","Grid","Divider","Typography","Radio","RadioGroup","FormControlLabel","FormControl","Button","TextField","Select","FormHelperText","firebase","Particulier","useOwner","Society","saveNewAccommodation","Loyer","Address","useStyles","theme","root","position","top","left","transform","outline","boxShadow","shadows","width","maxHeight","overflowY","maxWidth","actions","justifyContent","center","display","alignItems","divider","margin","titleSection","marginRight","marginLeft","gridCell","textField","marginTop","spacing","container","marginBottom","schema","address","presence","allowEmpty","message","isCommercial","schemaAddress","postalCode","length","maximum","minimum","street","city","schemaLoyer","fixe","charges","schemaRental","AddEstateModal","open","className","onClose","rest","classes","ownerInformations","isValid","values","rental","touched","errors","currentAccommo","setCurrentAccommo","createEstateDB","timestamp","Date","now","id","createEstate","handleChange","event","persist","formState","target","name","type","checked","value","handleChangeLoyer","loyer","handleChangeRental","handleChangeAddress","cancelClose","hasError","field","errorsGeneral","errorsAddress","errorsRental","errorsLoyer","Object","assign","keys","undefined","console","log","formControl","isParticulier","startDate","defaultProps"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport validate from \"validate.js\";\nimport clsx from \"clsx\";\nimport { makeStyles, withStyles } from \"@material-ui/styles\";\nimport {\n  Modal,\n  Card,\n  CardHeader,\n  CardContent,\n  CardActions,\n  Grid,\n  Divider,\n  Typography,\n  Radio,\n  RadioGroup,\n  FormControlLabel,\n  FormControl,\n  Button,\n  TextField,\n  Select,\n  FormHelperText,\n} from \"@material-ui/core\";\nimport firebase from \"firebase/app\";\nimport Particulier from \"./Particulier\";\nimport { useOwner } from \"../../../context/owner\";\nimport Society from \"./Society\";\nimport { saveNewAccommodation } from \"request/accomodationAPI\";\nimport Loyer from \"./Loyer\";\nimport Address from \"./Address\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    position: \"absolute\",\n    top: \"50%\",\n    left: \"50%\",\n    transform: \"translate(-50%, -50%)\",\n    outline: \"none\",\n    boxShadow: theme.shadows[20],\n    width: \"60%\",\n    maxHeight: \"90%\",\n    overflowY: \"auto\",\n    maxWidth: \"100%\",\n  },\n  actions: {\n    justifyContent: \"flex-end\",\n  },\n  center: {\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n  divider: {\n    margin: 10,\n  },\n  titleSection: {\n    marginRight: 15,\n    marginLeft: 10,\n  },\n  gridCell: {\n    alignItems: \"center\",\n  },\n  textField: {\n    marginTop: theme.spacing(2),\n  },\n  container: {\n    marginTop: 0,\n    marginBottom: theme.spacing(2),\n  },\n}));\n\nconst schema = {\n  address: {\n    presence: { allowEmpty: false, message: \"is required\" },\n  },\n  isCommercial: {\n    presence: { allowEmpty: false, message: \"is required\" },\n  },\n};\n\nconst schemaAddress = {\n  postalCode: {\n    presence: { allowEmpty: false, message: \"is required\" },\n    length: {\n      maximum: 5,\n      minimum: 5,\n    },\n  },\n  street: {\n    presence: { allowEmpty: false, message: \"is required\" },\n  },\n  city: {\n    presence: { allowEmpty: false, message: \"is required\" },\n  },\n};\n\nconst schemaLoyer = {\n  fixe: {\n    presence: { allowEmpty: false, message: \"is required\" },\n  },\n  charges: {\n    presence: { allowEmpty: false, message: \"is required\" },\n  },\n};\n\nconst schemaRental = {};\n\nfunction AddEstateModal({ open, className, onClose, ...rest }) {\n  const classes = useStyles();\n  const { ownerInformations } = useOwner();\n  const [currentAccommo, setCurrentAccommo] = useState({\n    isValid: false,\n    values: {\n      rental: {},\n      address: {},\n    },\n    touched: {},\n    errors: {},\n  });\n\n  function createEstateDB() {\n    const timestamp = Date.now();\n    saveNewAccommodation(\n      currentAccommo.values,\n      timestamp,\n      ownerInformations.id\n    );\n    onClose();\n  }\n\n  function createEstate() {\n    if (currentAccommo.isValid) {\n      createEstateDB();\n    }\n  }\n\n  const handleChange = (event) => {\n    event.persist();\n\n    setCurrentAccommo((formState) => ({\n      ...formState,\n      values: {\n        ...formState.values,\n        [event.target.name]:\n          event.target.type === \"checkbox\"\n            ? event.target.checked\n            : event.target.value,\n      },\n      touched: {\n        ...formState.touched,\n        [event.target.name]: true,\n      },\n    }));\n  };\n\n  const handleChangeLoyer = (event) => {\n    event.persist();\n\n    setCurrentAccommo((formState) => ({\n      ...formState,\n      values: {\n        ...formState.values,\n        loyer: {\n          ...formState.values.loyer,\n          [event.target.name]: event.target.value,\n        },\n      },\n      touched: {\n        ...formState.touched,\n        [event.target.name]: true,\n      },\n    }));\n  };\n\n  const handleChangeRental = (event) => {\n    event.persist();\n\n    setCurrentAccommo((formState) => ({\n      ...formState,\n      values: {\n        ...formState.values,\n        rental: {\n          ...formState.values.rental,\n          [event.target.name]: event.target.value,\n        },\n      },\n      touched: {\n        ...formState.touched,\n        [event.target.name]: true,\n      },\n    }));\n  };\n\n  const handleChangeAddress = (event) => {\n    event.persist();\n\n    setCurrentAccommo((formState) => ({\n      ...formState,\n      values: {\n        ...formState.values,\n        address: {\n          ...formState.values.address,\n          [event.target.name]: event.target.value,\n        },\n      },\n      touched: {\n        ...formState.touched,\n        [event.target.name]: true,\n      },\n    }));\n  };\n\n  const cancelClose = () => {\n    onClose();\n  };\n\n  const hasError = (field) =>\n    currentAccommo.touched[field] && currentAccommo.errors[field]\n      ? true\n      : false;\n\n  useEffect(() => {\n    const errorsGeneral = validate(currentAccommo.values, schema);\n    const errorsAddress = validate(\n      currentAccommo.values.address,\n      schemaAddress\n    );\n    const errorsRental = validate(currentAccommo.values.rental, schemaRental);\n    const errorsLoyer = validate(currentAccommo.values.loyer, schemaLoyer);\n\n    let errors = Object.assign(\n      {},\n      errorsGeneral,\n      errorsAddress,\n      errorsRental,\n      errorsLoyer\n    );\n\n    if (Object.keys(errors).length === 0) {\n      errors = undefined;\n    }\n\n    console.log(\"errors\", errors)\n\n    setCurrentAccommo((formState) => ({\n      ...formState,\n      isValid: errors ? false : true,\n      errors: errors || {},\n    }));\n  }, [currentAccommo.values]);\n\n  if (!open) {\n    return null;\n  }\n\n  return (\n    <Modal onClose={onClose} open={open}>\n      <Card {...rest} className={clsx(classes.root, className)}>\n        <CardHeader title={\"Ajouter un nouveau bien\"} />\n        <Divider />\n        <CardContent>\n          <FormControl\n            component=\"fieldset\"\n            error={true}\n            className={classes.formControl}\n          >\n            <RadioGroup\n              row\n              name=\"isCommercial\"\n              defaultValue=\"top\"\n              onChange={handleChange}\n              className={classes.gridCell}\n            >\n              <Typography variant=\"h4\" className={classes.titleSection}>\n                1. Type de bien\n              </Typography>\n              <FormControlLabel\n                value={\"false\"}\n                control={\n                  <Radio\n                    color=\"primary\"\n                    checked={currentAccommo.values.isCommercial === \"false\"}\n                  />\n                }\n                label=\"Habitation\"\n                labelPlacement=\"right\"\n              />\n              <FormControlLabel\n                value={\"true\"}\n                control={\n                  <Radio\n                    color=\"primary\"\n                    checked={currentAccommo.values.isCommercial === \"true\"}\n                  />\n                }\n                label=\"Local Commercial\"\n                labelPlacement=\"right\"\n              />\n            </RadioGroup>\n            {hasError(\"isCommercial\") ? (\n              <Typography>currentAccommo.errors.isCommercial[0]</Typography>\n            ) : null}\n          </FormControl>\n          <Typography variant=\"h4\" className={classes.titleSection}>\n            2. Adresse\n          </Typography>\n\n          <Address\n            handleChange={handleChangeAddress}\n            currentAccommo={currentAccommo}\n          />\n\n          <RadioGroup\n            row\n            name=\"isParticulier\"\n            defaultValue=\"top\"\n            onChange={handleChangeRental}\n            className={classes.gridCell}\n          >\n            <Typography variant=\"h4\" className={classes.titleSection}>\n              3. Locataire\n            </Typography>\n            <FormControlLabel\n              value={\"null\"}\n              control={\n                <Radio\n                  color=\"primary\"\n                  checked={\n                    currentAccommo.values.rental.isParticulier === \"null\"\n                  }\n                />\n              }\n              label=\"Vide\"\n              labelPlacement=\"right\"\n            />\n            <FormControlLabel\n              value={\"true\"}\n              control={\n                <Radio\n                  color=\"primary\"\n                  checked={\n                    currentAccommo.values.rental.isParticulier === \"true\"\n                  }\n                />\n              }\n              label=\"Particulier\"\n              labelPlacement=\"right\"\n            />\n            <FormControlLabel\n              value={\"false\"}\n              control={\n                <Radio\n                  color=\"primary\"\n                  checked={\n                    currentAccommo.values.rental.isParticulier === \"false\"\n                  }\n                />\n              }\n              label=\"Entreprise\"\n              labelPlacement=\"right\"\n            />\n          </RadioGroup>\n          <TextField\n            size=\"small\"\n            fullWidth\n            error={hasError(\"startDate\")}\n            helperText={\n              hasError(\"startDate\") ? currentAccommo.errors.startDate[0] : null\n            }\n            label=\"Date d'entrée\"\n            name=\"startDate\"\n            onChange={handleChangeRental}\n            type=\"text\"\n            value={\n              (currentAccommo.values.rental != undefined &&\n                currentAccommo.values.rental.startDate) ||\n              \"\"\n            }\n            variant=\"outlined\"\n          />\n          <div className={classes.container}>\n            {currentAccommo.values.rental.isParticulier === \"true\" && (\n              <Particulier\n                handleChange={handleChangeRental}\n                currentOwner={currentAccommo.values}\n                disabled={true}\n              />\n            )}\n            {currentAccommo.values.rental.isParticulier === \"false\" && (\n              <Society\n                handleChange={handleChangeRental}\n                currentEstate={currentAccommo.values}\n                disabled={true}\n              />\n            )}\n          </div>\n\n          <Typography variant=\"h4\" className={classes.titleSection}>\n            4. Loyer\n          </Typography>\n          <Loyer\n            handleChange={handleChangeLoyer}\n            currentEstate={currentAccommo.values}\n          />\n        </CardContent>\n        <Divider />\n        <CardActions disableSpacing>\n          <Button onClick={cancelClose}>annuler</Button>\n          <Button onClick={createEstate}>créer</Button>\n        </CardActions>\n      </Card>\n    </Modal>\n  );\n}\n\nAddEstateModal.propTypes = {\n  className: PropTypes.string,\n  onClose: PropTypes.func,\n  open: PropTypes.bool,\n};\n\nAddEstateModal.defaultProps = {\n  open: false,\n  onClose: () => {},\n};\n\nexport default AddEstateModal;\n"]},"metadata":{},"sourceType":"module"}