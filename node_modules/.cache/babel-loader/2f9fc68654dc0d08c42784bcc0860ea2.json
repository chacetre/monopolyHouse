{"ast":null,"code":"var _jsxFileName = \"/Users/charlottecetre/Desktop/Macron business/src/views/Receipt/index.js\";\nimport React, { useState, useEffect } from \"react\";\nimport { makeStyles } from \"@material-ui/styles\";\nimport { func } from \"prop-types\";\nimport { Typography, Button, Divider, IconButton } from \"@material-ui/core\";\nimport Table from \"@material-ui/core/Table\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableContainer from \"@material-ui/core/TableContainer\";\nimport TableHead from \"@material-ui/core/TableHead\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport Paper from \"@material-ui/core/Paper\";\nimport html2canvas from \"html2canvas\";\nimport Template from \"./Template\";\nimport jsPDF from \"jspdf\";\nimport { AddRounded } from \"@material-ui/icons\";\nimport { useUser } from \"../../context/userInformations\";\nimport { getAccomodationByOwner } from \"request/accomodationAPI\";\nimport MonthYearPicker from \"components/MonthYearPicker\";\nconst useStyles = makeStyles(theme => ({\n  root: {\n    padding: theme.spacing(3),\n    margin: theme.spacing(2)\n  },\n  content: {\n    marginBottom: theme.spacing(2)\n  },\n  destinataire: {\n    color: theme.palette.primary.main\n  },\n  expediteur: {\n    textAlign: \"right\"\n  },\n  page: {\n    position: \"absolute\",\n    opacity: 0,\n    pointerEvents: \"none\"\n  },\n  pageBis: {\n    backgroundColor: \"#fff000\",\n    width: \"210mm\",\n    height: \"297mm\",\n    padding: 30\n  },\n  divider: {\n    margin: 20\n  },\n  test: {\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  }\n}));\n\nconst Receipt = () => {\n  const classes = useStyles();\n  const currentDate = new Date().toLocaleString(\"default\", {\n    month: \"long\",\n    year: \"numeric\"\n  });\n  const {\n    userInformations\n  } = useUser();\n  const [accommodations, setData] = useState(null);\n  const [dateReceipt, setDateReceipt] = useState({});\n  const [showPicker, setShowPicker] = useState(true);\n\n  function createPDF() {\n    console.log(\"create PDF\");\n    const input = document.querySelector(\".divToPrint\");\n\n    if (input != null) {\n      html2canvas(input).then(canvas => {\n        const image = canvas.toDataURL(\"image/png\");\n        const pdf = jsPDF(\"p\", \"mm\", \"a4\");\n        const width = 210;\n        const height = 297;\n        pdf.addImage(image, 0, 0, width, height);\n        pdf.save(\"download.pdf\");\n      });\n    } else {\n      console.log(\"isNULL\");\n    }\n  }\n\n  function calculateLoyer(estate) {\n    var numFixe = Number(estate.loyer.fixe);\n    var numCharges = Number(estate.loyer.charges);\n    var numTVA = estate.isCommercial == undefined ? Number(estate.loyer.tva) : 0;\n    return numFixe + numCharges + numTVA;\n  }\n\n  function getAccommodationsInformations() {\n    getAccomodationByOwner(userInformations.id, response => {\n      setData(response);\n    });\n  }\n\n  function showCalendar() {\n    setShowPicker(prev => !prev);\n  }\n\n  useEffect(() => {\n    getAccommodationsInformations();\n  }, []);\n  useEffect(() => {\n    getAccommodationsInformations();\n  }, [currentDate]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.root,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.content,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    variant: \"h2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 9\n    }\n  }, \"EDITION DES QUITTANCES ET APPELS DE LOYER\"), /*#__PURE__*/React.createElement(Typography, {\n    variant: \"overline\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 9\n    }\n  }, \"Date actuelle:\", \" \", currentDate.toLocaleString(\"default\", {\n    month: \"long\"\n  }))), /*#__PURE__*/React.createElement(MonthYearPicker, {\n    open: showPicker,\n    initialValue: currentDate.toLocaleString(\"default\", {\n      month: \"long\"\n    }),\n    onClose: (monthReturn, yearReturn) => {\n      console.log(\"return value\", monthReturn);\n      setDateReceipt({\n        month: monthReturn,\n        year: yearReturn\n      });\n      setShowPicker(false);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(TableContainer, {\n    component: Paper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Table, {\n    className: classes.table,\n    \"aria-label\": \"simple table\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TableHead, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(TableRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 15\n    }\n  }, \"Logements\"), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 15\n    }\n  }, \"Locataire\"), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 15\n    }\n  }, \"Montant du loyer\"), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 15\n    }\n  }, \"Appel de loyer\"), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 15\n    }\n  }, \"Quittance\"))), /*#__PURE__*/React.createElement(TableBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 11\n    }\n  }, accommodations != undefined && Object.values(accommodations).map(row => /*#__PURE__*/React.createElement(TableRow, {\n    key: row.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(TableCell, {\n    component: \"th\",\n    scope: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 21\n    }\n  }, row.address.street.toUpperCase()), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 21\n    }\n  }, row.address.otherInformations), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 21\n    }\n  }, row.address.city.toUpperCase())), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 19\n    }\n  }, !row.isParticulier ? row.rental.civility.toUpperCase() + \" \" + row.rental.firstname.toUpperCase() + \" \" + row.rental.lastname.toUpperCase() : row.rental.socialIdentity), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 19\n    }\n  }, calculateLoyer(row), \" \\u20AC\"), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    size: \"small\",\n    variant: \"contained\",\n    onClick: createPDF,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 21\n    }\n  }, currentDate), /*#__PURE__*/React.createElement(IconButton, {\n    onClick: showCalendar,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(AddRounded, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 23\n    }\n  }))), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    size: \"small\",\n    variant: \"contained\",\n    onClick: createPDF,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 21\n    }\n  }, currentDate), /*#__PURE__*/React.createElement(IconButton, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(AddRounded, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 23\n    }\n  })))))))), /*#__PURE__*/React.createElement(Template, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 7\n    }\n  }));\n};\n\nexport default Receipt;","map":{"version":3,"sources":["/Users/charlottecetre/Desktop/Macron business/src/views/Receipt/index.js"],"names":["React","useState","useEffect","makeStyles","func","Typography","Button","Divider","IconButton","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Paper","html2canvas","Template","jsPDF","AddRounded","useUser","getAccomodationByOwner","MonthYearPicker","useStyles","theme","root","padding","spacing","margin","content","marginBottom","destinataire","color","palette","primary","main","expediteur","textAlign","page","position","opacity","pointerEvents","pageBis","backgroundColor","width","height","divider","test","display","justifyContent","alignItems","Receipt","classes","currentDate","Date","toLocaleString","month","year","userInformations","accommodations","setData","dateReceipt","setDateReceipt","showPicker","setShowPicker","createPDF","console","log","input","document","querySelector","then","canvas","image","toDataURL","pdf","addImage","save","calculateLoyer","estate","numFixe","Number","loyer","fixe","numCharges","charges","numTVA","isCommercial","undefined","tva","getAccommodationsInformations","id","response","showCalendar","prev","monthReturn","yearReturn","table","Object","values","map","row","address","street","toUpperCase","otherInformations","city","isParticulier","rental","civility","firstname","lastname","socialIdentity"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { makeStyles } from \"@material-ui/styles\";\nimport { func } from \"prop-types\";\nimport { Typography, Button, Divider, IconButton } from \"@material-ui/core\";\nimport Table from \"@material-ui/core/Table\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableContainer from \"@material-ui/core/TableContainer\";\nimport TableHead from \"@material-ui/core/TableHead\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport Paper from \"@material-ui/core/Paper\";\nimport html2canvas from \"html2canvas\";\nimport Template from \"./Template\";\nimport jsPDF from \"jspdf\";\nimport { AddRounded } from \"@material-ui/icons\";\nimport { useUser } from \"../../context/userInformations\";\nimport { getAccomodationByOwner } from \"request/accomodationAPI\";\nimport MonthYearPicker from \"components/MonthYearPicker\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    padding: theme.spacing(3),\n   margin: theme.spacing(2),\n  },\n  content: {\n    marginBottom: theme.spacing(2),\n  },\n  destinataire: {\n    color: theme.palette.primary.main,\n  },\n  expediteur: {\n    textAlign: \"right\",\n  },\n  page: {\n    position: \"absolute\",\n    opacity: 0,\n    pointerEvents: \"none\",\n  },\n  pageBis: {\n    backgroundColor: \"#fff000\",\n    width: \"210mm\",\n    height: \"297mm\",\n    padding: 30,\n  },\n  divider: {\n    margin: 20,\n  },\n  test: {\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  }, \n}));\n\nconst Receipt = () => {\n  const classes = useStyles();\n  const currentDate = new Date().toLocaleString(\"default\", {\n    month: \"long\",\n    year: \"numeric\",\n  });\n  const { userInformations } = useUser();\n  const [accommodations, setData] = useState(null);\n  const [dateReceipt, setDateReceipt] = useState({});\n  const [showPicker, setShowPicker] = useState(true);\n\n  function createPDF() {\n    console.log(\"create PDF\");\n\n    const input = document.querySelector(\".divToPrint\");\n    if (input != null) {\n      html2canvas(input).then((canvas) => {\n        const image = canvas.toDataURL(\"image/png\");\n        const pdf = jsPDF(\"p\", \"mm\", \"a4\");\n        const width = 210;\n        const height = 297;\n        pdf.addImage(image, 0, 0, width, height);\n        pdf.save(\"download.pdf\");\n      });\n    } else {\n      console.log(\"isNULL\");\n    }\n  }\n\n  function calculateLoyer(estate) {\n    var numFixe = Number(estate.loyer.fixe);\n    var numCharges = Number(estate.loyer.charges);\n    var numTVA =\n      estate.isCommercial == undefined ? Number(estate.loyer.tva) : 0;\n\n    return numFixe + numCharges + numTVA;\n  }\n\n  function getAccommodationsInformations() {\n    getAccomodationByOwner(userInformations.id, (response) => {\n      setData(response);\n    });\n  }\n\n  function showCalendar() {\n    setShowPicker((prev) => !prev);\n  }\n\n  useEffect(() => {\n    getAccommodationsInformations();\n  }, []);\n\n  useEffect(() => {\n    getAccommodationsInformations();\n  }, [currentDate]);\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.content}>\n        <Typography variant=\"h2\">\n          EDITION DES QUITTANCES ET APPELS DE LOYER\n        </Typography>\n        <Typography variant=\"overline\">\n          Date actuelle:{\" \"}\n          {currentDate.toLocaleString(\"default\", { month: \"long\" })}\n        </Typography>\n      </div>\n\n      <MonthYearPicker\n        open={showPicker}\n        initialValue={currentDate.toLocaleString(\"default\", { month: \"long\" })}\n        onClose={(monthReturn, yearReturn) => {\n          console.log(\"return value\", monthReturn);\n          setDateReceipt({ month: monthReturn, year: yearReturn });\n          setShowPicker(false);\n        }}\n      />\n\n      <TableContainer component={Paper}>\n        <Table className={classes.table} aria-label=\"simple table\">\n          <TableHead>\n            <TableRow>\n              <TableCell>Logements</TableCell>\n              <TableCell>Locataire</TableCell>\n              <TableCell align=\"right\">Montant du loyer</TableCell>\n              <TableCell align=\"right\">Appel de loyer</TableCell>\n              <TableCell align=\"right\">Quittance</TableCell>\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {accommodations != undefined &&\n              Object.values(accommodations).map((row) => (\n                <TableRow key={row.id}>\n                  <TableCell component=\"th\" scope=\"row\">\n                    <div>{row.address.street.toUpperCase()}</div>\n                    <div>{row.address.otherInformations}</div>\n                    <div>{row.address.city.toUpperCase()}</div>\n                  </TableCell>\n                  <TableCell>\n                    {!row.isParticulier\n                      ? row.rental.civility.toUpperCase() +\n                        \" \" +\n                        row.rental.firstname.toUpperCase() +\n                        \" \" +\n                        row.rental.lastname.toUpperCase()\n                      : row.rental.socialIdentity}\n                  </TableCell>\n                  <TableCell align=\"right\">{calculateLoyer(row)} €</TableCell>\n                  <TableCell align=\"right\">\n                    <Button\n                      size=\"small\"\n                      variant=\"contained\"\n                      onClick={createPDF}\n                    >\n                      {currentDate}\n                    </Button>\n                    <IconButton onClick={showCalendar}>\n                      <AddRounded />\n                    </IconButton>\n                  </TableCell>\n                  <TableCell align=\"right\">\n                    <Button\n                      size=\"small\"\n                      variant=\"contained\"\n                      onClick={createPDF}\n                    >\n                      {currentDate}\n                    </Button>\n                    <IconButton>\n                      <AddRounded />\n                    </IconButton>\n                  </TableCell>\n                </TableRow>\n              ))}\n          </TableBody>\n        </Table>\n      </TableContainer>\n\n      <Template/>\n      \n    </div>\n  );\n};\n\nexport default Receipt;\n"]},"metadata":{},"sourceType":"module"}