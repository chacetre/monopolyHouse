{"ast":null,"code":"var _jsxFileName = \"/Users/charlottecetre/Desktop/Macron business/src/views/Receipt/index.js\";\nimport React, { useState, useEffect } from \"react\";\nimport { makeStyles } from \"@material-ui/styles\";\nimport { func } from \"prop-types\";\nimport { Typography, Button, Divider, IconButton } from \"@material-ui/core\";\nimport Table from \"@material-ui/core/Table\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableContainer from \"@material-ui/core/TableContainer\";\nimport TableHead from \"@material-ui/core/TableHead\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport Paper from \"@material-ui/core/Paper\";\nimport html2canvas from \"html2canvas\";\nimport Template from \"./Template\";\nimport jsPDF from \"jspdf\";\nimport { AddRounded } from \"@material-ui/icons\";\nimport { useUser } from \"../../context/userInformations\";\nimport { getAccomodationByOwner } from \"request/accomodationAPI\";\nimport MonthYearPicker from \"components/MonthYearPicker\";\nconst useStyles = makeStyles(theme => ({\n  root: {\n    padding: theme.spacing(3),\n    margin: theme.spacing(2)\n  },\n  content: {\n    marginBottom: theme.spacing(2)\n  },\n  destinataire: {\n    color: theme.palette.primary.main\n  },\n  expediteur: {\n    textAlign: \"right\"\n  },\n  page: {\n    position: \"absolute\",\n    opacity: 0,\n    pointerEvents: \"none\"\n  },\n  pageBis: {\n    backgroundColor: \"#fff000\",\n    width: \"210mm\",\n    height: \"297mm\",\n    padding: 30\n  },\n  divider: {\n    margin: 20\n  },\n  test: {\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  }\n}));\n\nconst Receipt = () => {\n  const classes = useStyles();\n  const currentDate = new Date().toLocaleString(\"default\", {\n    month: \"long\",\n    year: \"numeric\"\n  });\n  const {\n    userInformations\n  } = useUser();\n  const [accommodations, setData] = useState(null);\n  const [currentAccomodation, setCurrentAccommodation] = useState(null);\n  const [dateReceipt, setDateReceipt] = useState({});\n  const [showPicker, setShowPicker] = useState(false);\n\n  function createPDF(currentAccomodation) {\n    console.log(\"create PDF\");\n    var namePDF = currentAccomodation.rental.firstname + \"_\" + currentAccomodation.rental.lastname + \"_\" + dateReceipt.month + \"_\" + dateReceipt.year + \".pdf\";\n    const input = document.querySelector(\".divToPrint\");\n\n    if (input != null) {\n      html2canvas(input).then(canvas => {\n        const image = canvas.toDataURL(\"image/png\");\n        const pdf = jsPDF(\"p\", \"mm\", \"a4\");\n        const width = 210;\n        const height = 297;\n        pdf.addImage(image, 0, 0, width, height);\n        pdf.save(namePDF);\n      });\n    } else {\n      console.log(\"isNULL\");\n    }\n  }\n\n  function calculateLoyer(estate) {\n    var numFixe = Number(estate.loyer.fixe);\n    var numCharges = Number(estate.loyer.charges);\n    var numTVA = estate.isCommercial == undefined ? Number(estate.loyer.tva) : 0;\n    return numFixe + numCharges + numTVA;\n  }\n\n  function getAccommodationsInformations() {\n    getAccomodationByOwner(userInformations.id, response => {\n      setData(response);\n    });\n  }\n\n  function showCalendar(currentAccomodation) {\n    setShowPicker(prev => !prev);\n    setCurrentAccommodation(currentAccomodation);\n  }\n\n  useEffect(() => {\n    getAccommodationsInformations();\n  }, []);\n  useEffect(() => {\n    if (currentDate != undefined) {\n      var splitDate = currentDate.split(\" \");\n      setDateReceipt({\n        month: splitDate[0],\n        year: splitDate[1]\n      });\n    }\n  }, [currentDate]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.root,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.content,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    variant: \"h2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 9\n    }\n  }, \"EDITION DES QUITTANCES ET APPELS DE LOYER\"), /*#__PURE__*/React.createElement(Typography, {\n    variant: \"overline\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 9\n    }\n  }, \"Date actuelle:\", \" \", currentDate.toLocaleString(\"default\", {\n    month: \"long\"\n  }))), /*#__PURE__*/React.createElement(MonthYearPicker, {\n    open: showPicker,\n    initialValue: currentDate.toLocaleString(\"default\", {\n      month: \"long\"\n    }),\n    onClose: (monthReturn, yearReturn) => {\n      console.log(\"return value\", monthReturn);\n      setDateReceipt({\n        month: monthReturn,\n        year: yearReturn\n      });\n      createPDF(currentAccomodation);\n      setShowPicker(false);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(TableContainer, {\n    component: Paper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Table, {\n    className: classes.table,\n    \"aria-label\": \"simple table\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TableHead, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(TableRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 15\n    }\n  }, \"Logements\"), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 15\n    }\n  }, \"Locataire\"), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 15\n    }\n  }, \"Montant du loyer\"), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 15\n    }\n  }, \"Appel de loyer\"), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 15\n    }\n  }, \"Quittance\"))), /*#__PURE__*/React.createElement(TableBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 11\n    }\n  }, accommodations != undefined && Object.values(accommodations).map(row => /*#__PURE__*/React.createElement(TableRow, {\n    key: row.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(TableCell, {\n    component: \"th\",\n    scope: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 21\n    }\n  }, row.address.street.toUpperCase()), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 21\n    }\n  }, row.address.otherInformations), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 21\n    }\n  }, row.address.city.toUpperCase())), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 19\n    }\n  }, !row.isParticulier ? row.rental.civility.toUpperCase() + \" \" + row.rental.firstname.toUpperCase() + \" \" + row.rental.lastname.toUpperCase() : row.rental.socialIdentity), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 19\n    }\n  }, calculateLoyer(row), \" \\u20AC\"), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    size: \"small\",\n    variant: \"contained\",\n    onClick: () => createPDF(row),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 21\n    }\n  }, currentDate), /*#__PURE__*/React.createElement(IconButton, {\n    onClick: () => showCalendar(row),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(AddRounded, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 23\n    }\n  }))), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    size: \"small\",\n    variant: \"contained\",\n    onClick: createPDF,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 21\n    }\n  }, currentDate), /*#__PURE__*/React.createElement(Template, {\n    owner: userInformations,\n    accomodation: row,\n    date: dateReceipt,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(IconButton, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(AddRounded, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 23\n    }\n  })))))))));\n};\n\nexport default Receipt;","map":{"version":3,"sources":["/Users/charlottecetre/Desktop/Macron business/src/views/Receipt/index.js"],"names":["React","useState","useEffect","makeStyles","func","Typography","Button","Divider","IconButton","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Paper","html2canvas","Template","jsPDF","AddRounded","useUser","getAccomodationByOwner","MonthYearPicker","useStyles","theme","root","padding","spacing","margin","content","marginBottom","destinataire","color","palette","primary","main","expediteur","textAlign","page","position","opacity","pointerEvents","pageBis","backgroundColor","width","height","divider","test","display","justifyContent","alignItems","Receipt","classes","currentDate","Date","toLocaleString","month","year","userInformations","accommodations","setData","currentAccomodation","setCurrentAccommodation","dateReceipt","setDateReceipt","showPicker","setShowPicker","createPDF","console","log","namePDF","rental","firstname","lastname","input","document","querySelector","then","canvas","image","toDataURL","pdf","addImage","save","calculateLoyer","estate","numFixe","Number","loyer","fixe","numCharges","charges","numTVA","isCommercial","undefined","tva","getAccommodationsInformations","id","response","showCalendar","prev","splitDate","split","monthReturn","yearReturn","table","Object","values","map","row","address","street","toUpperCase","otherInformations","city","isParticulier","civility","socialIdentity"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { makeStyles } from \"@material-ui/styles\";\nimport { func } from \"prop-types\";\nimport { Typography, Button, Divider, IconButton } from \"@material-ui/core\";\nimport Table from \"@material-ui/core/Table\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableContainer from \"@material-ui/core/TableContainer\";\nimport TableHead from \"@material-ui/core/TableHead\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport Paper from \"@material-ui/core/Paper\";\nimport html2canvas from \"html2canvas\";\nimport Template from \"./Template\";\nimport jsPDF from \"jspdf\";\nimport { AddRounded } from \"@material-ui/icons\";\nimport { useUser } from \"../../context/userInformations\";\nimport { getAccomodationByOwner } from \"request/accomodationAPI\";\nimport MonthYearPicker from \"components/MonthYearPicker\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    padding: theme.spacing(3),\n    margin: theme.spacing(2),\n  },\n  content: {\n    marginBottom: theme.spacing(2),\n  },\n  destinataire: {\n    color: theme.palette.primary.main,\n  },\n  expediteur: {\n    textAlign: \"right\",\n  },\n  page: {\n    position: \"absolute\",\n    opacity: 0,\n    pointerEvents: \"none\",\n  },\n  pageBis: {\n    backgroundColor: \"#fff000\",\n    width: \"210mm\",\n    height: \"297mm\",\n    padding: 30,\n  },\n  divider: {\n    margin: 20,\n  },\n  test: {\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n}));\n\nconst Receipt = () => {\n  const classes = useStyles();\n  const currentDate = new Date().toLocaleString(\"default\", {\n    month: \"long\",\n    year: \"numeric\",\n  });\n  const { userInformations } = useUser();\n  const [accommodations, setData] = useState(null);\n  const [currentAccomodation, setCurrentAccommodation] = useState(null);\n  const [dateReceipt, setDateReceipt] = useState({});\n  const [showPicker, setShowPicker] = useState(false);\n\n  function createPDF(currentAccomodation) {\n    console.log(\"create PDF\");\n\n    var namePDF = currentAccomodation.rental.firstname + \"_\" + currentAccomodation.rental.lastname + \"_\" + dateReceipt.month + \"_\" + dateReceipt.year + \".pdf\"\n\n    const input = document.querySelector(\".divToPrint\");\n    if (input != null) {\n      html2canvas(input).then((canvas) => {\n        const image = canvas.toDataURL(\"image/png\");\n        const pdf = jsPDF(\"p\", \"mm\", \"a4\");\n        const width = 210;\n        const height = 297;\n        pdf.addImage(image, 0, 0, width, height);\n        pdf.save(namePDF);\n      });\n    } else {\n      console.log(\"isNULL\");\n    }\n  }\n\n  function calculateLoyer(estate) {\n    var numFixe = Number(estate.loyer.fixe);\n    var numCharges = Number(estate.loyer.charges);\n    var numTVA =\n      estate.isCommercial == undefined ? Number(estate.loyer.tva) : 0;\n\n    return numFixe + numCharges + numTVA;\n  }\n\n  function getAccommodationsInformations() {\n    getAccomodationByOwner(userInformations.id, (response) => {\n      setData(response);\n    });\n  }\n\n  function showCalendar(currentAccomodation) {\n    setShowPicker((prev) => !prev);\n    setCurrentAccommodation(currentAccomodation)\n  }\n\n  useEffect(() => {\n    getAccommodationsInformations();\n  }, []);\n\n  useEffect(() => {\n    if (currentDate != undefined) {\n\n      var splitDate = currentDate.split(\" \");\n      setDateReceipt({\n        month: splitDate[0],\n        year: splitDate[1],\n      });\n    }\n  }, [currentDate]);\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.content}>\n        <Typography variant=\"h2\">\n          EDITION DES QUITTANCES ET APPELS DE LOYER\n        </Typography>\n        <Typography variant=\"overline\">\n          Date actuelle:{\" \"}\n          {currentDate.toLocaleString(\"default\", { month: \"long\" })}\n        </Typography>\n      </div>\n\n      <MonthYearPicker\n        open={showPicker}\n        initialValue={currentDate.toLocaleString(\"default\", { month: \"long\" })}\n        onClose={(monthReturn, yearReturn) => {\n          console.log(\"return value\", monthReturn);\n          setDateReceipt({ month: monthReturn, year: yearReturn });\n          createPDF(currentAccomodation)\n          setShowPicker(false);\n        }}\n      />\n\n      <TableContainer component={Paper}>\n        <Table className={classes.table} aria-label=\"simple table\">\n          <TableHead>\n            <TableRow>\n              <TableCell>Logements</TableCell>\n              <TableCell>Locataire</TableCell>\n              <TableCell align=\"right\">Montant du loyer</TableCell>\n              <TableCell align=\"right\">Appel de loyer</TableCell>\n              <TableCell align=\"right\">Quittance</TableCell>\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {accommodations != undefined &&\n              Object.values(accommodations).map((row) => (\n                <TableRow key={row.id}>\n                  <TableCell component=\"th\" scope=\"row\">\n                    <div>{row.address.street.toUpperCase()}</div>\n                    <div>{row.address.otherInformations}</div>\n                    <div>{row.address.city.toUpperCase()}</div>\n                  </TableCell>\n                  <TableCell>\n                    {!row.isParticulier\n                      ? row.rental.civility.toUpperCase() +\n                        \" \" +\n                        row.rental.firstname.toUpperCase() +\n                        \" \" +\n                        row.rental.lastname.toUpperCase()\n                      : row.rental.socialIdentity}\n                  </TableCell>\n                  <TableCell align=\"right\">{calculateLoyer(row)} €</TableCell>\n                  <TableCell align=\"right\">\n                    <Button\n                      size=\"small\"\n                      variant=\"contained\"\n                      onClick={() => createPDF(row)}\n                    >\n                      {currentDate}\n                    </Button>\n                    <IconButton onClick={() => showCalendar(row)}>\n                      <AddRounded />\n                    </IconButton>\n                  </TableCell>\n                  <TableCell align=\"right\">\n                    <Button\n                      size=\"small\"\n                      variant=\"contained\"\n                      onClick={createPDF}\n                    >\n                      {currentDate}\n                    </Button>\n                    <Template owner={userInformations} accomodation={row} date={dateReceipt} />\n                    <IconButton>\n                      <AddRounded />\n                    </IconButton>\n                  </TableCell>\n                </TableRow>\n              ))}\n          </TableBody>\n        </Table>\n      </TableContainer>\n\n      \n    </div>\n  );\n};\n\nexport default Receipt;\n"]},"metadata":{},"sourceType":"module"}